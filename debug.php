<?php/* * @ Work name: PRipple * @ Author: cclilshy jingnigg@gmail.com * @ Copyright (c) 2023. by user email: jingnigg@gmail.com, All Rights Reserved. */$server = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);socket_set_nonblock($server);socket_bind($server, '127.0.0.1', 2221);socket_listen($server);$httpResult = <<<EOFHTTP/1.1 200 OKContent-Type: text/plainContent-Length: 12Hello World!EOF;$clients = array();while (true) {    $listens = array_merge($clients, [$server]);    if (socket_select($listens, $_, $_, 0, 1000000)) {        foreach ($listens as $socket) {            if ($socket === $server) {                $client                            = socket_accept($server);                $clients[spl_object_hash($client)] = $client;            } else {                $len = socket_recv($socket, $result, 1024, 0);                if ($len !== false && $len !== 0) {                    socket_send($socket, $httpResult, strlen($httpResult), MSG_EOF);                } else {                    socket_close($socket);                    unset($clients[spl_object_hash($socket)]);                }            }        }    } else {        echo 'wait...' . PHP_EOL;    }}